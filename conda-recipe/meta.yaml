{% set name = "aligncount-demo" %}
{% set version = "0.1.0" %}

package:
  name: {{ name }}
  version: {{ version }}

source:
  url: <PLACEHOLDER>
  sha256: <PLACEHOLDER>

build:
  number: 0
  requirements:
    build:
      - {{ compiler("cxx") }}
      - cmake
      - python
      - pip
      - setuptools
      - scikit-build
    host:
      - python
      - pip
      - setuptools
      - scikit-build
    run:
      - python

  script: |
    mkdir build
    cd build
    cmake .. -DCMAKE_INSTALL_PREFIX=$PREFIX
    cmake --build . --parallel ${CPU_COUNT:-1}
    cmake --install . --prefix $PREFIX
    cd ..
    # This bypasses PEP 517 and uses setuptools directly
    python setup.py install --single-version-externally-managed --record=record.txt

about:
  home: <PLACEHOLDER>
  license: MIT
  summary: "C++ linecount + Python wrapper"
